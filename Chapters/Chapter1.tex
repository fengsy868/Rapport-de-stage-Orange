% Chapter 1

\chapter{Introduction} % Main chapter title

\label{Chapter1} % For referencing the chapter elsewhere, use \ref{Chapter1}

\lhead{Chapter 1. \emph{Introduction}} % This is for the header on each page - perhaps a shortened title

%----------------------------------------------------------------------------------------

Monte Carlo methods are a common and accurate way to model particle transport by solving with few approximations the radiation transport equation \citep{Reference1, Reference2}. However, to ensure this accuracy, the Monte Carlo method sacrifices its computing performance on producing a large number of repeated random samplings \citep{Reference4}, because of a very slow convergence rate. Therefore, the acceleration of computational Monte Carlo algorithms turns out to be necessary. Numerical acceleration methods are known to be very efficient, but only computational optimizations will be tackled in this work.

Recently, certain emerging computational accelerators such as General-Purpose Graphics Processing Units (GPGPU), CPU (Central Processing Unit) cluster and Xeon Phi are widely explored for their potentials on large-scale computing. Note that even these accelerators are far less powerful than the top-500 supercomputers; they possess more attractive ratios on performance/price and performance/watt \citep{Reference1}. In addition, Monte Carlo algorithms are ideally suited to parallel processing architectures and so are good candidates for acceleration using these tools \citep{Reference3}. For an item more specific, NVIDIA has published OptiX - a highly optimized ray tracing engine based on NVIDIA’s CUDA (Compute Unified Device Architecture) architecture. This engine is created initially to handle graphics problems. However, instead of being a ray tracer itself, OptiX provides developers with a scalable framework for building any kind of ray tracing based applications \citep{Reference6}. By using this low-level ray tracing support, developers may obtain an impressive speedup with few optimizations on their original algorithms.

Électricité de France (EDF) uses radiographic inspection for systematic pipe control so as to ensure security on nuclear power plants \citep{Reference5}. MODERATO code is a software developed at EDF R\&D (Research \& Development) in order to simulate the inspection process. Using the Monte Carlo method, MODERATO traces photons emitted by gamma source and then simulates images obtained on radiographic films. It is a very useful simulation tool to help finding the best configuration before on-site inspection.

The present report describes the work I have done during my six months internship at EDF R\&D. In order to benefit of all advantages of GPU accelerators, my mission was to evaluate the adaptation of MODERATO to the optimized ray tracing frameworks on these devices. The following part of this chapter will at first give a brief introduction about the organization: the structure of the entire R\&D center will be presented as well as the research group I worked with. Then, outline of the report will be listed.
%----------------------------------------------------------------------------------------

\section{Company Presentation}
EDF \citep{edf} is one of the world's largest energy producer that specializes in electricity, from engineering to distribution. The company's main operations are electricity generation and distribution; power plant design, construction and dismantling; energy trading; and transport. It is active in such power generation technologies as nuclear power, hydropower, marine energies, wind power, solar energy, biomass, geothermal energy and fossil-fired energy.

Due to a growing energy demand while tackling climate change and managing resource depletion, EDF keeps on innovation and remains the lowest carbon emitter among the major European energy companies, especially electric utilities, adapt fleet and customer offers to promote climate protection and reduce environmental impact \citep{edfgroup}.

In order to produce more environment-friendly electricity, the EDF Group invests lots of efforts on innovation activities. The seven international research centres (including three in France, one in Germany, one in the UK, one in Poland and one in China) enhance the Group's industrial performance and provide strong foundation of a solid future through medium-and long-range planning.

In particular, among all fifteen departments at R\&D, the SINETICS (SImulation NEutronique, Technologies de l’Information et Calcul Scientifique) is specialized in nuclear safety simulation and scientific computing. It consists of six research group \citep{sinetics}:
%------------------------------------
\begin{itemize}
  \it
  \setstretch{1} % Reset the line-spacing to 1
  \item \textbf{Computing Infrastructure, Communication and Security Group (I2D): }Communications infrastructure on activities of network data and communications between heterogeneous systems, embedded communication systems and the safety of these infrastructures and systems.
  \item \textbf{Reactor Neutronic Simulation Group (I27):} Chains of reactor neutron calculations and the modeling of nuclear fuel behavior.
  \item \textbf{Virtual Reality and Scientific Visualization Group (I2C):} Pre and post treatment of numerical analyse, risk prediction and intervention preparation in controlled area.
	\item \textbf{Numerical Analysis and Models Group (I23):} Numerical methods and HPC strategies  for simulations on reactor neutron behavior, non destructive testing (radiographic, ultrasonic), hydraulics and other mechanic activities, etc.
	\item \textbf{Cycle Safety and Physics Group (I28):} Development and justification of EDF's strategy on the management of fuel cycle, evaluating alternatives for the renewal of nuclear power plants.
	\item \textbf{Architecture of Information System and Scientific Computing Group (I2A):} Bringing together expertise in information systems architecture and software architecture for scientific computing applied to high performance computing.
\end{itemize}
%------------------------------------
During these six months, I integrated in the I23 group and focused on scientific computing and its optimization with computational accelerators. The group has about 20 members. Generally speaking, they have a formal meeting every two weeks (réunion du groupe). Small technique gatherings are more frequent among the people in the same project. Communication for group members is convenient since all offices are closed. Moreover, EDF provides staff members with internal message and telephone service, which improve working efficiency as well.
%----------------------------------------------------------------------------------------

\section{Outline}
A very initial investigation on the ray tracing CPU/GPU portability of MODERATO will be introduced in this report. In a first part I will introduce the radiographic inspection and its simulation with MODERATO. Then I will briefly give some details on several popular HPC (High Performance Computing) accelerators: CPU cluster, Xeon Phi and GPGPU. At the end of this part, two available ray tracing framework for scientific calculations will be described.

Chapter 3 will cover how to build ray tracing softwares with OptiX framework. It first explains programming models defined in OptiX. OptiX \textit{Host Objects} and \textit{Device Programs} will be detailed with code examples. Besides, how to perform CUDA/OptiX communications and the comparison of three RNGs (Random Number Generators) will be presented. At last, OptiX performance guidelines and programming caveats help a more efficient implementation work.

The following chapter focuses on modeling process in OptiX. The procedure of porting the original code to OptiX will be described. Then, it goes over several important points of our OptiX implementation. Optimizations like reductions and selection of RNGs will be discussed. Problems and corresponding solutions will be fully detailed at the end of this chapter.

The final chapter introduces the tests we have done to evaluate and validate the OptiX implementation. Firstly, test configurations such as models of sources, inspected objects and detectors will be presented. Then, in order to verify effectiveness and accuracy of CUDA Fast-Math Intrinsic Functions (Compared to the traditional IEEE 754 standard), tests on this item will be presented with explanations. Moreover, kernel size can have an influence on ray tracing performance as well: even if a 1000$\times$1000 kernel has been proved to be more productive than a 500$\times$500 one on calculations, its poor efficiency during initialization may always be a non-negligible drawback. Therefore, some tests were realized to find the optimal balance between calculation and initialization. Another test concerns the degradation of serialized operations during parallel computing: utilization of atomic operations within OptiX and their accuracy will be discussed. The chapter also evaluates OptiX performance by comparing it with a CPU cluster. In the end, the chapter draws conclusions from the previous test results. Apart from the advantages on using OptiX, difficulties and inconveniences during implementation will be discussed. After these concluding remarks, a future road-map for this OptiX implementation is proposed, and the amount of work needed to make it featured.
